Idea for 5.1:

Create a dict with rules for each number and then simply iterate over puzzle data to check
whether the certain number satisfies the rules

Idea for 5.2:

Current solution is based on custom and more complicated version of bubble sort, and that is not okay
since the time complexity is quite high. 

It is necessary to find a way to optimize the solution.